Scopo

Questo programma monitora i pacchetti SYN in entrata su una macchina (assumiamo di ricevere solo pacchetti syn destinati alla macchina stessa) per rilevare potenziali port scan. Quando viene individuato un IP sospetto, viene stampato un avviso sul terminale e scritto su file di log. Ogni minuto i dati vengono salvati in un database RRD e viene generato un grafico con i SYN degli ultimi 10 minuti.

Requisiti

Assicurati che il sistema abbia installati (sudo apt install):
build-essential per il compilatore ed il comando make, libpcap-dev, rrdtool per il database ed il grafico
xdg-utils per aprire il PNG, nmap per testare.

Compilazione

Dalla cartella del progetto esegui:
	make
Questo creerà gli eseguibili (RilevatoreSynScan e Scan).

Avvio

1. Avvia il rilevatore:
	sudo ./RilevatoreSynScan
Facoltativo: per modalità debug, che stampa la tabella hash (con gli IP sospetti e le relative porte contattate) e info aggiuntive sui syn in tempo reale, avvia:
	sudo ./RilevatoreSynScan -d
2. Scegli l’interfaccia da monitorare (verranno elencate e numerate).
3. Una volta attivato il monitoraggio in condizioni normali il codice non dovrebbe rilevare nessuno scan, quindi ne dobbimo simulare uno noi
4. Il programma si arresta con Ctrl+C. 

Eseguire una scansione di test (su un’altra shell)

Per simulare uno scan locale (solo per test sulla tua macchina o su host autorizzati):
	sudo ./Scan	
il programma chiederà se vuoi scansionare localhost o un altro IP
Oppure usa direttamente nmap:
	sudo nmap -sS -p 1-1024 <target-ip>

Cosa succede quando viene rilevato uno scan

Sul terminale vedrai un messaggio di allarme con l’IP sospetto.
L’evento viene scritto in scan_alert.log.
I SYN raccolti nell’ultimo minuto vengono aggiornati in scan.rrd e viene rigenerato scan.png.
Ogni minuto vengono aggiornati il file scan.rrd ed il grafico scan.png che mostra l’andamento dei SYN ricevuti negli ultimi 10 minuti
Per visualizzare il grafico si può utilizzare:
	xdg-open scan.png
